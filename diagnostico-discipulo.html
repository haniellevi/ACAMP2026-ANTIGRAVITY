<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perfil do Disc√≠pulo ‚Äî Diagn√≥stico</title>

  <!-- SEO Meta Tags -->
  <meta name="description"
    content="Descubra em que fase da jornada de discipulado voc√™ est√°. Diagn√≥stico completo com 25 perguntas em 5 categorias. Acampamento 2026.">
  <meta name="author" content="Igreja Filadelfia Corrente">
  <meta name="theme-color" content="#6c5ce7">

  <!-- Open Graph / Facebook / WhatsApp -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Perfil do Disc√≠pulo ‚Äî Diagn√≥stico Espiritual">
  <meta property="og:description"
    content="üå± Descubra em que fase da jornada de discipulado voc√™ est√°. 25 perguntas, 5 categorias, resultado instant√¢neo. ‚õ∫ Acampamento 2026">
  <meta property="og:image" content="https://haniellevi.github.io/ACAMP2026-ANTIGRAVITY/og-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="https://haniellevi.github.io/ACAMP2026-ANTIGRAVITY/diagnostico-discipulo.html">
  <meta property="og:site_name" content="Acampamento 2026">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Perfil do Disc√≠pulo ‚Äî Diagn√≥stico Espiritual">
  <meta name="twitter:description"
    content="üå± Descubra em que fase da jornada de discipulado voc√™ est√°. ‚õ∫ Acampamento 2026">
  <meta name="twitter:image" content="https://haniellevi.github.io/ACAMP2026-ANTIGRAVITY/og-image.png">

  <!-- Favicon SVG inline -->
  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%236c5ce7'/%3E%3Cstop offset='100%25' style='stop-color:%23a855f7'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='200' height='200' rx='40' fill='%230a0e17'/%3E%3Ccircle cx='100' cy='100' r='75' fill='none' stroke='url(%23g)' stroke-width='2.5' opacity='.4'/%3E%3Crect x='93' y='55' width='14' height='90' rx='7' fill='url(%23g)'/%3E%3Crect x='70' y='78' width='60' height='14' rx='7' fill='url(%23g)'/%3E%3Cpath d='M100 42Q110 55 100 62Q90 55 100 42Z' fill='%2300cec9' opacity='.9'/%3E%3Ccircle cx='82' cy='138' r='4.5' fill='%234ade80' opacity='.7'/%3E%3Ccircle cx='118' cy='138' r='4.5' fill='%234ade80' opacity='.7'/%3E%3C/svg%3E">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box
    }

    :root {
      --bg: #0a0e17;
      --surface: #131926;
      --surface2: #1a2235;
      --border: #252d42;
      --primary: #6c5ce7;
      --primary-g: linear-gradient(135deg, #6c5ce7, #a855f7);
      --accent: #00cec9;
      --gold: #ffd700;
      --text: #e2e8f0;
      --muted: #8892a8;
      --seed: linear-gradient(135deg, #4ade80, #22c55e);
      --sprout: linear-gradient(135deg, #38bdf8, #0ea5e9);
      --tree: linear-gradient(135deg, #a78bfa, #7c3aed);
      --fire: linear-gradient(135deg, #f97316, #ef4444);
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden
    }

    .container {
      max-width: 720px;
      margin: 0 auto;
      padding: 20px
    }

    /* HERO */
    .hero {
      text-align: center;
      padding: 60px 20px 40px;
      position: relative
    }

    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, rgba(108, 92, 231, .15), transparent 70%);
      pointer-events: none
    }

    .hero h1 {
      font-size: 2.2em;
      font-weight: 900;
      background: var(--primary-g);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 8px
    }

    .hero p {
      color: var(--muted);
      font-size: 1em;
      max-width: 500px;
      margin: 0 auto
    }

    .badge {
      display: inline-block;
      margin-top: 16px;
      padding: 6px 18px;
      border-radius: 20px;
      background: var(--surface2);
      border: 1px solid var(--border);
      font-size: .8em;
      color: var(--accent);
      font-weight: 600
    }

    /* PROGRESS */
    .progress-bar {
      margin: 30px 0 20px;
      background: var(--surface);
      border-radius: 12px;
      height: 8px;
      overflow: hidden;
      border: 1px solid var(--border)
    }

    .progress-fill {
      height: 100%;
      background: var(--primary-g);
      border-radius: 12px;
      transition: width .5s cubic-bezier(.4, 0, .2, 1);
      width: 0
    }

    .progress-text {
      text-align: center;
      font-size: .85em;
      color: var(--muted);
      margin-bottom: 24px
    }

    /* STEP INDICATORS */
    .step-indicators {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin: 20px 0 10px;
    }

    .step-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--surface2);
      border: 2px solid var(--border);
      cursor: pointer;
      transition: all .3s;
    }

    .step-dot.active {
      background: var(--primary);
      border-color: var(--primary);
      transform: scale(1.2);
    }

    .step-dot.completed {
      background: var(--accent);
      border-color: var(--accent);
    }

    .step-label {
      text-align: center;
      font-size: .8em;
      color: var(--muted);
      margin-bottom: 20px;
    }

    /* PAGE CONTAINER */
    .quiz-page {
      display: none;
      animation: fadeSlide .4s ease;
    }

    .quiz-page.active {
      display: block;
    }

    @keyframes fadeSlide {
      from {
        opacity: 0;
        transform: translateX(30px);
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    /* PAGINATION NAV */
    .pagination-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-top: 24px;
    }

    .btn-nav {
      padding: 14px 28px;
      border: 2px solid var(--primary);
      border-radius: 12px;
      background: transparent;
      color: var(--primary);
      font-weight: 700;
      font-size: .9em;
      cursor: pointer;
      transition: all .2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-nav:hover {
      background: var(--primary);
      color: #fff;
      transform: translateY(-2px);
    }

    .btn-nav:disabled {
      opacity: .3;
      cursor: not-allowed;
      transform: none;
    }

    .btn-nav:disabled:hover {
      background: transparent;
      color: var(--primary);
    }

    .btn-nav.primary {
      background: var(--primary-g);
      border: none;
      color: #fff;
    }

    .btn-nav.primary:hover {
      box-shadow: 0 8px 25px rgba(108, 92, 231, .3);
    }

    .page-counter {
      font-size: .85em;
      color: var(--muted);
      font-weight: 600;
    }

    .cat-answered {
      font-size: .78em;
      color: var(--accent);
      font-weight: 600;
      text-align: center;
      margin-top: 8px;
    }

    /* CATEGORY */
    .category-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 10px 0 16px;
      padding: 14px 20px;
      background: var(--surface);
      border-radius: 14px;
      border: 1px solid var(--border)
    }

    .cat-icon {
      font-size: 1.6em
    }

    .cat-info h2 {
      font-size: 1.05em;
      font-weight: 700;
      margin-bottom: 2px
    }

    .cat-info span {
      font-size: .78em;
      color: var(--muted)
    }

    /* QUESTION */
    .question {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 22px;
      margin-bottom: 14px;
      transition: border-color .3s, box-shadow .3s
    }

    .question.answered {
      border-color: var(--primary);
      box-shadow: 0 0 20px rgba(108, 92, 231, .08)
    }

    .question .q-num {
      font-size: .72em;
      font-weight: 700;
      color: var(--primary);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 6px
    }

    .question .q-text {
      font-size: .95em;
      font-weight: 600;
      margin-bottom: 14px;
      line-height: 1.5
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 8px
    }

    .option {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      border-radius: 12px;
      border: 1px solid var(--border);
      cursor: pointer;
      transition: all .25s;
      background: var(--surface2)
    }

    .option:hover {
      border-color: var(--primary);
      transform: translateX(4px)
    }

    .option.selected {
      background: rgba(108, 92, 231, .12);
      border-color: var(--primary);
      box-shadow: 0 0 12px rgba(108, 92, 231, .1)
    }

    .option .radio {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all .25s
    }

    .option.selected .radio {
      border-color: var(--primary);
      background: var(--primary)
    }

    .option.selected .radio::after {
      content: '';
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #fff
    }

    .option .label {
      font-size: .88em;
      color: var(--muted);
      transition: color .25s
    }

    .option.selected .label {
      color: var(--text);
      font-weight: 500
    }

    /* BUTTON */
    .btn-submit {
      display: block;
      width: 100%;
      padding: 18px;
      border: none;
      border-radius: 14px;
      background: var(--primary-g);
      color: #fff;
      font-size: 1.05em;
      font-weight: 700;
      cursor: pointer;
      margin-top: 30px;
      transition: transform .2s, box-shadow .2s;
      text-transform: uppercase;
      letter-spacing: 1px
    }

    .btn-submit:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 30px rgba(108, 92, 231, .3)
    }

    .btn-submit:disabled {
      opacity: .4;
      cursor: not-allowed;
      transform: none;
      box-shadow: none
    }

    /* RESULT */
    .result {
      display: none;
      text-align: center;
      padding: 40px 20px;
      animation: fadeUp .6s ease
    }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(30px)
      }

      to {
        opacity: 1;
        transform: translateY(0)
      }
    }

    .result-icon {
      font-size: 4em;
      margin-bottom: 16px
    }

    .result-title {
      font-size: 1.8em;
      font-weight: 900;
      margin-bottom: 4px
    }

    .result-score {
      font-size: 3.5em;
      font-weight: 900;
      background: var(--primary-g);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      margin: 10px 0
    }

    .result-profile {
      font-size: 1.2em;
      font-weight: 700;
      margin-bottom: 8px;
      padding: 8px 24px;
      border-radius: 30px;
      display: inline-block
    }

    .result-desc {
      color: var(--muted);
      max-width: 480px;
      margin: 16px auto 30px;
      line-height: 1.7;
      font-size: .95em
    }

    /* CATEGORY SCORES */
    .cat-scores {
      display: grid;
      gap: 12px;
      margin: 20px 0 30px
    }

    .cat-score-item {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 16px 20px
    }

    .cat-score-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px
    }

    .cat-score-name {
      font-size: .88em;
      font-weight: 600
    }

    .cat-score-val {
      font-size: .85em;
      font-weight: 700;
      color: var(--primary)
    }

    .cat-score-bar {
      height: 6px;
      background: var(--surface2);
      border-radius: 6px;
      overflow: hidden
    }

    .cat-score-fill {
      height: 100%;
      border-radius: 6px;
      transition: width 1s ease
    }

    .btn-retry {
      display: inline-block;
      padding: 14px 36px;
      border: 2px solid var(--primary);
      border-radius: 12px;
      background: transparent;
      color: var(--primary);
      font-weight: 700;
      font-size: .95em;
      cursor: pointer;
      margin-top: 10px;
      transition: all .2s
    }

    .btn-retry:hover {
      background: var(--primary);
      color: #fff
    }

    @media(max-width:600px) {
      .hero h1 {
        font-size: 1.6em
      }

      .container {
        padding: 12px
      }

      .question {
        padding: 16px
      }
    }

    /* PRINT STYLES */
    @media print {
      @page {
        margin: 20mm;
        size: auto;
      }

      /* Tenta remover cabe√ßalhos/rodap√©s do navegador */

      body {
        background: #fff;
        color: #000;
        -webkit-print-color-adjust: exact;
      }

      .container {
        max-width: 100%;
        padding: 0;
        margin: 0;
        box-shadow: none;
        border: none;
      }

      .hero,
      #quiz-section,
      .btn-retry,
      .btn-print,
      #syncStatus,
      .badge {
        display: none !important;
      }

      .result {
        display: block !important;
        padding: 0;
        animation: none;
      }

      .result-score {
        -webkit-text-fill-color: initial;
        color: #000;
      }

      .result-profile {
        background: #f0f0f0 !important;
        color: #333 !important;
        border: 1px solid #ccc;
        box-shadow: none;
      }

      .cat-score-item {
        break-inside: avoid;
        border: 1px solid #eee;
        page-break-inside: avoid;
      }

      .cat-score-fill {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }

      /* Custom Header for Print */
      .print-header {
        display: block !important;
        margin-bottom: 30px;
        border-bottom: 2px solid #000;
        padding-bottom: 10px;
      }

      .print-header h1 {
        font-size: 24px;
        margin: 0;
        color: #000;
        text-transform: uppercase;
      }

      .print-header p {
        margin: 5px 0 0;
        font-size: 14px;
        color: #555;
      }

      .print-info {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 15px;
        font-size: 14px;
      }
    }

    /* Hide print header on screen */
    .print-header {
      display: none;
    }

    .btn-print {
      display: inline-block;
      padding: 14px 36px;
      border: none;
      border-radius: 12px;
      background: var(--surface2);
      color: var(--text);
      font-weight: 700;
      font-size: .95em;
      cursor: pointer;
      margin-top: 10px;
      margin-left: 10px;
      transition: all .2s;
    }

    .btn-print:hover {
      background: var(--border);
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="hero">
      <h1>PERFIL DO DISC√çPULO</h1>
      <p>Descubra em que fase da jornada de discipulado voc√™ est√° e quais √°reas precisam de aten√ß√£o.</p>

      <!-- USER FORM -->
      <div
        style="max-width:400px;margin:20px auto;text-align:left;background:var(--surface);padding:20px;border-radius:12px;border:1px solid var(--border)">
        <div style="margin-bottom:12px">
          <label style="display:block;font-size:0.85em;color:var(--muted);margin-bottom:6px">Seu Nome Completo</label>
          <input type="text" id="userName" placeholder="Ex: Jo√£o da Silva"
            style="width:100%;padding:10px;background:var(--surface2);border:1px solid var(--border);color:var(--text);border-radius:8px;outline:none">
        </div>

        <div style="margin-bottom:12px">
          <label style="display:block;font-size:0.85em;color:var(--muted);margin-bottom:6px">Sua Igreja</label>
          <select id="userChurch" onchange="toggleOtherChurch()"
            style="width:100%;padding:10px;background:var(--surface2);border:1px solid var(--border);color:var(--text);border-radius:8px;outline:none">
            <option value="IGREJA FILADELFIA CORRENTE">IGREJA FILADELFIA CORRENTE</option>
            <option value="OUTRA">OUTRA (Digitar nome)</option>
          </select>
        </div>

        <div id="otherChurchDiv" style="display:none;margin-bottom:12px">
          <label style="display:block;font-size:0.85em;color:var(--muted);margin-bottom:6px">Nome da Igreja</label>
          <input type="text" id="otherChurchName" placeholder="Digite o nome da sua igreja"
            style="width:100%;padding:10px;background:var(--surface2);border:1px solid var(--border);color:var(--text);border-radius:8px;outline:none">
        </div>

        <button class="btn-submit" onclick="startQuiz()" style="margin-top:10px;padding:12px;font-size:0.95em">INICIAR
          DIAGN√ìSTICO</button>
        <div class="badge" style="display:block;text-align:center;margin-top:10px;background:none;border:none">‚è± ~5
          minutos ‚Ä¢ 25 perguntas</div>
      </div>
    </div>

    <div id="quiz-section">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">0 de 25 respondidas</div>
      <div class="step-indicators" id="stepIndicators"></div>
      <div class="step-label" id="stepLabel"></div>
      <div id="questions"></div>
    </div>

    <div class="result" id="resultSection">
      <!-- PRINT ONLY HEADER -->
      <div class="print-header">
        <h1>Relat√≥rio de Diagn√≥stico</h1>
        <p>Perfil do Disc√≠pulo ‚Ä¢ Acampamento 2026</p>
        <div class="print-info">
          <div><strong id="printName">Nome:</strong> </div>
          <div><strong id="printChurch">Igreja:</strong> </div>
          <div><strong>Data:</strong> <span id="printDate"></span></div>
        </div>
      </div>

      <div class="result-icon" id="resIcon"></div>
      <div class="result-title" id="resTitle"></div>
      <div class="result-score" id="resScore"></div>
      <div class="result-profile" id="resProfile"></div>
      <div class="result-desc" id="resDesc"></div>
      <h3 style="margin-bottom:14px;font-size:1em">Pontua√ß√£o por Categoria</h3>
      <div class="cat-scores" id="catScores"></div>
      <button class="btn-retry" onclick="location.reload()">‚Üª Refazer</button>
      <button class="btn-print" onclick="window.print()">üìÑ Salvar PDF</button>
    </div>
  </div>


  <!-- SYNC STATUS INDICATOR -->
  <div id="syncStatus"
    style="display:none;position:fixed;bottom:20px;right:20px;background:var(--surface2);padding:12px 20px;border-radius:30px;border:1px solid var(--border);box-shadow:0 10px 30px rgba(0,0,0,0.5);align-items:center;gap:10px;z-index:999">
    <span id="syncIcon">üîÑ</span>
    <span id="syncMsg" style="font-size:0.85em;font-weight:600">Enviando dados...</span>
  </div>

  <script>
    // CONFIRA AQUI A URL DO SEU SCRIPT GOOGLE QUANDO CRIAR
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxmQJeAuf-7dYByCXk91yrQoeixft88EIW5IAfVgg9y2__Kd0QJ0mi8NLqOn5pLfdOQkQ/exec';

    // --- DADOS E VARI√ÅVEIS GLOBAIS ---
    const CATS = [
      { id: 'renuncia', name: 'Ren√∫ncia e Compromisso', icon: 'üè¥', color: '#ef4444' },
      { id: 'mente', name: 'Renova√ß√£o da Mente', icon: 'üß†', color: '#6c5ce7' },
      { id: 'comunhao', name: 'Comunh√£o e Relacionamento', icon: 'ü§ù', color: '#00cec9' },
      { id: 'honra', name: 'Honra e Lealdade', icon: 'üëë', color: '#ffd700' },
      { id: 'servico', name: 'Servi√ßo e Multiplica√ß√£o', icon: 'üõ†Ô∏è', color: '#f97316' }
    ];

    const QS = [
      // REN√öNCIA (1-5)
      { cat: 0, q: 'Quando algo que eu quero conflita com o que Deus pede, eu:', opts: ['Sigo minha vontade sem pensar', 'Fico dividido e geralmente fa√ßo o que quero', 'Luto internamente mas tento obedecer', 'Renuncio minha vontade com convic√ß√£o'] },
      { cat: 0, q: 'Minha vida de ora√ß√£o e devocional pessoal √©:', opts: ['Praticamente inexistente', 'Espor√°dica, s√≥ quando preciso de algo', 'Regular, mas ainda inconsistente', 'Di√°ria e intencional ‚Äî √© prioridade'] },
      { cat: 0, q: 'Quando enfrento dificuldade por causa da f√©, eu:', opts: ['Questiono se vale a pena seguir a Jesus', 'Fico desanimado e me afasto um pouco', 'Me apoio em Deus mas sinto o peso', 'Entendo que faz parte e persevero com alegria'] },
      { cat: 0, q: 'Meu compromisso com a igreja local √©:', opts: ['Vou quando tenho vontade ou n√£o tenho nada melhor', 'Frequento mas sem muito envolvimento', 'Sou presente e participo das atividades', 'Estou comprometido como alian√ßa, n√£o como op√ß√£o'] },
      { cat: 0, q: 'Em rela√ß√£o ao meu tempo, dinheiro e talentos para o Reino:', opts: ['N√£o penso nisso como algo que devo a Deus', 'Contribuo quando sobra ou √© conveniente', 'Dizimo e oferto, mas ainda sou apegado ao control', 'Entendo que tudo √© de Deus e administro como mordomo'] },
      // MENTE (6-10)
      { cat: 1, q: 'Quando ou√ßo um ensino b√≠blico que confronta meu estilo de vida, eu:', opts: ['Ignoro ou descarto como "radical demais"', 'Fico incomodado mas n√£o mudo nada', 'Reflito e come√ßo a fazer ajustes', 'Abra√ßo a mudan√ßa mesmo que doa'] },
      { cat: 1, q: 'Minha mentalidade em rela√ß√£o √† igreja √© mais de:', opts: ['"O que a igreja faz por mim?" (consumidor)', '"Eu vou quando me conv√©m" (visitante)', 'Estou disposto a contribuir (participante)', '"O que eu posso fazer pelo Reino?" (disc√≠pulo)'] },
      { cat: 1, q: 'Quando passo por uma crise pessoal, minha rea√ß√£o √©:', opts: ['Reclamar de Deus e da lideran√ßa', 'Ficar distante e resolver sozinho', 'Buscar ajuda mas com certa resist√™ncia', 'Interceder, buscar a Palavra e apoiar a comunidade'] },
      { cat: 1, q: 'Em rela√ß√£o √† renova√ß√£o da mente (mudar padr√µes de pensamento):', opts: ['N√£o entendo do que se trata', 'Sei que preciso mas n√£o sei como', 'Estou no processo, lendo e meditando na Palavra', 'Minha mente √© constantemente alimentada por verdades b√≠blicas'] },
      { cat: 1, q: 'Quando vejo outro crist√£o errando, minha primeira rea√ß√£o √©:', opts: ['Comentar com outros sobre o erro', 'Julgar internamente', 'Sentir compaix√£o mas n√£o fazer nada', 'Orar e, se apropriado, restaurar com mansid√£o'] },
      // COMUNH√ÉO (11-15)
      { cat: 2, q: 'Meu envolvimento com um pequeno grupo ou c√©lula √©:', opts: ['N√£o participo de nenhum grupo', 'Participo √†s vezes quando posso', 'Frequento regularmente', 'Sou comprometido e ajudo o grupo a crescer'] },
      { cat: 2, q: 'Em rela√ß√£o a compartilhar minhas lutas e vit√≥rias com outros crist√£os:', opts: ['N√£o me abro com ningu√©m', 'Falo superficialmente quando perguntam', 'Tenho uma ou duas pessoas de confian√ßa', 'Pratico transpar√™ncia e vulnerabilidade na comunidade'] },
      { cat: 2, q: 'Quando um irm√£o/irm√£ da f√© est√° passando por dificuldade:', opts: ['Geralmente nem fico sabendo', 'Digo "vou orar" mas esque√ßo', 'Oro e mando uma mensagem de apoio', 'Vou at√© a pessoa, ajudo com a√ß√£o pr√°tica e oro junto'] },
      { cat: 2, q: 'Sobre construir relacionamentos de discipulado (mentoria):', opts: ['Nunca tive um mentor espiritual', 'J√° tive mas n√£o deu certo', 'Tenho algu√©m que me acompanha √†s vezes', 'Tenho mentor e tamb√©m mentoreio algu√©m'] },
      { cat: 2, q: 'Quando h√° conflito entre irm√£os na igreja, eu:', opts: ['Fico de um lado e falo mal do outro', 'Evito o assunto completamente', 'Tento ser pacificador mas de longe', 'Vou diretamente buscar reconcilia√ß√£o conforme Mateus 18'] },
      // HONRA (16-20)
      { cat: 3, q: 'Quando a lideran√ßa da igreja toma uma decis√£o com a qual discordo:', opts: ['Reclamo com outros membros', 'Critico internamente e fico ressentido', 'Fico em sil√™ncio mas n√£o apoio', 'Converso em particular com respeito e apoio a decis√£o final'] },
      { cat: 3, q: 'Em rela√ß√£o √† honra e reconhecimento dos meus l√≠deres:', opts: ['Raramente penso nisso', 'Honro quando √© conveniente', 'Respeito a posi√ß√£o mas nem sempre a pessoa', 'Honro a un√ß√£o e a pessoa, independente de falhas'] },
      { cat: 3, q: 'Quando ou√ßo fofoca sobre um l√≠der ou irm√£o, eu:', opts: ['Ou√ßo e passo para frente', 'Ou√ßo mas n√£o compartilho', 'Mudo de assunto', 'Interrompo e defendo o ausente'] },
      { cat: 3, q: 'Minha postura em rela√ß√£o √† autoridade (pais, chefes, l√≠deres):', opts: ['Tenho problema com autoridade em geral', 'Respeito quando merecem', 'Entendo o principio mas nem sempre pratico', 'Honro como princ√≠pio b√≠blico, mesmo quando √© dif√≠cil'] },
      { cat: 3, q: 'Se meu l√≠der comete um erro p√∫blico, minha rea√ß√£o √©:', opts: ['Contar para outros e usar como justificativa para sair', 'Perder a confian√ßa e me afastar', 'Ficar decepcionado mas manter dist√¢ncia', '"Cobrir" com ora√ß√£o, apoiar a restaura√ß√£o e manter lealdade'] },
      // SERVI√áO (21-25)
      { cat: 4, q: 'Em rela√ß√£o ao voluntariado na igreja, eu:', opts: ['N√£o sirvo em nenhuma √°rea', 'Servo quando pedem, mas sem compromisso', 'Sirvo em uma √°rea com regularidade', 'Sirvo por chamado e procuro novas oportunidades'] },
      { cat: 4, q: 'Eu conhe√ßo meus dons espirituais e como us√°-los?', opts: ['N√£o sei quais s√£o meus dons', 'Tenho uma ideia vaga', 'Conhe√ßo alguns e uso quando posso', 'Conhe√ßo bem e sirvo ativamente com eles'] },
      { cat: 4, q: 'Sobre evangelismo e compartilhar minha f√©:', opts: ['Nunca falei de Jesus para algu√©m', 'Falo muito raramente e com vergonha', 'Compartilho quando surge oportunidade', 'Busco intencionalmente oportunidades para testemunhar'] },
      { cat: 4, q: 'Se algu√©m me pedisse para discipular um novo convertido, eu:', opts: ['N√£o me sentiria capaz de forma alguma', 'Ficaria inseguro e provavelmente recusaria', 'Tentaria com aux√≠lio de material', 'Aceitaria com alegria ‚Äî j√° fa√ßo ou estou pronto'] },
      { cat: 4, q: 'Minha vis√£o sobre o meu papel na expans√£o do Reino de Deus:', opts: ['Isso √© trabalho de pastor e mission√°rio', 'Sei que deveria participar mas n√£o sei como', 'Estou come√ßando a entender meu papel', 'Sei que EU sou o agente do Reino onde piso'] }
    ];

    let answers = new Array(25).fill(null);
    let userData = { name: '', church: '' };
    let currentPage = 0;

    // Esconde o quiz inicialmente e mostra s√≥ o form (Hero j√° tem o form)
    document.getElementById('quiz-section').style.display = 'none';

    // --- FUN√á√ïES DE INTERFACE ---

    function toggleOtherChurch() {
      const sel = document.getElementById('userChurch').value;
      const div = document.getElementById('otherChurchDiv');
      div.style.display = sel === 'OUTRA' ? 'block' : 'none';
    }

    function startQuiz() {
      const name = document.getElementById('userName').value.trim();
      let church = document.getElementById('userChurch').value;

      if (church === 'OUTRA') {
        const other = document.getElementById('otherChurchName').value.trim();
        if (!other) { alert('Por favor, digite o nome da sua igreja.'); return; }
        church = other;
      }

      if (!name) { alert('Por favor, digite seu nome para come√ßar.'); return; }

      userData.name = name;
      userData.church = church;

      document.querySelector('.hero').style.display = 'none';
      document.getElementById('quiz-section').style.display = 'block';

      renderQuestions();
      renderStepIndicators();
      goToPage(0);
    }

    function renderStepIndicators() {
      let html = '';
      CATS.forEach((c, i) => {
        html += `<div class="step-dot" id="step${i}" onclick="goToPage(${i})" title="${c.name}"></div>`;
      });
      document.getElementById('stepIndicators').innerHTML = html;
    }

    function updateStepIndicators() {
      CATS.forEach((c, i) => {
        const dot = document.getElementById(`step${i}`);
        const catAnswered = answers.slice(i * 5, i * 5 + 5).filter(a => a !== null).length;
        dot.className = 'step-dot';
        if (i === currentPage) dot.classList.add('active');
        else if (catAnswered === 5) dot.classList.add('completed');
      });
      const c = CATS[currentPage];
      const catAnswered = answers.slice(currentPage * 5, currentPage * 5 + 5).filter(a => a !== null).length;
      document.getElementById('stepLabel').innerHTML = `${c.icon} ${c.name} <span style="color:var(--accent)">(${catAnswered}/5)</span>`;
    }

    function renderQuestions() {
      const qDiv = document.getElementById('questions');
      let html = '';

      CATS.forEach((cat, catIdx) => {
        html += `<div class="quiz-page" id="page${catIdx}">`;
        html += `<div class="category-header"><div class="cat-icon">${cat.icon}</div><div class="cat-info"><h2>${cat.name}</h2><span>Perguntas ${catIdx * 5 + 1}-${catIdx * 5 + 5}</span></div></div>`;

        for (let qi = catIdx * 5; qi < catIdx * 5 + 5; qi++) {
          const q = QS[qi];
          let optsWithVal = q.opts.map((text, idx) => ({ text, val: idx + 1 }));

          // Fisher-Yates Shuffle
          for (let k = optsWithVal.length - 1; k > 0; k--) {
            const j = Math.floor(Math.random() * (k + 1));
            [optsWithVal[k], optsWithVal[j]] = [optsWithVal[j], optsWithVal[k]];
          }

          html += `<div class="question" id="q${qi}"><div class="q-num">Pergunta ${qi + 1}</div><div class="q-text">${q.q}</div><div class="options">`;
          optsWithVal.forEach((o, j) => {
            html += `<div class="option" onclick="pick(${qi}, ${o.val}, ${j})" id="o${qi}_${j}"><div class="radio"></div><div class="label">${o.text}</div></div>`;
          });
          html += '</div></div>';
        }

        // Navigation buttons
        html += '<div class="pagination-nav">';
        if (catIdx > 0) {
          html += `<button class="btn-nav" onclick="goToPage(${catIdx - 1})">‚Üê Anterior</button>`;
        } else {
          html += '<div></div>';
        }
        html += `<span class="page-counter">${catIdx + 1} de ${CATS.length}</span>`;
        if (catIdx < CATS.length - 1) {
          html += `<button class="btn-nav primary" onclick="goToPage(${catIdx + 1})">Pr√≥xima ‚Üí</button>`;
        } else {
          html += `<button class="btn-submit" id="btnSubmit" disabled onclick="showResult()" style="margin:0;padding:14px 28px;font-size:.9em;width:auto">VER MEU PERFIL ‚ú®</button>`;
        }
        html += '</div>';

        html += '</div>'; // close quiz-page
      });

      qDiv.innerHTML = html;
    }

    function goToPage(pageIdx) {
      document.querySelectorAll('.quiz-page').forEach(p => p.classList.remove('active'));
      const page = document.getElementById(`page${pageIdx}`);
      page.classList.add('active');
      currentPage = pageIdx;
      updateStepIndicators();
      window.scrollTo({ top: document.getElementById('quiz-section').offsetTop - 10, behavior: 'smooth' });
    }

    // Updated pick function: receives Value (score) instead of Index
    function pick(qi, score, visualIndex) {
      answers[qi] = score;

      // Update UI selection based on visual index (0-3)
      for (let j = 0; j < 4; j++) {
        document.getElementById(`o${qi}_${j}`).classList.toggle('selected', j === visualIndex);
      }

      document.getElementById(`q${qi}`).classList.add('answered');
      updateProgress();
      updateStepIndicators();
    }

    function updateProgress() {
      const done = answers.filter(a => a !== null).length;
      document.getElementById('progressFill').style.width = (done / 25 * 100) + '%';
      document.getElementById('progressText').textContent = `${done} de 25 respondidas`;
      const btn = document.getElementById('btnSubmit');
      if (btn) btn.disabled = done < 25;
    }

    // SOBRESCREVE A FUN√á√ÉO showResult ORIGINAL PARA INCLUIR O ENVIO
    window.showResult = function () {
      const total = answers.reduce((a, b) => a + b, 0);
      const catTotals = CATS.map((_, i) => answers.slice(i * 5, i * 5 + 5).reduce((a, b) => a + b, 0));

      let icon, title, profile, desc, gradient;
      if (total <= 40) { icon = 'üå±'; title = 'SEMENTE'; gradient = 'var(--seed)'; profile = 'In√≠cio da Jornada'; desc = 'Voc√™ est√° no come√ßo do caminho do discipulado. Isso n√£o √© ruim ‚Äî toda grande √°rvore come√ßou como semente! Busque um mentor, inscreva-se em um pequeno grupo e comprometa-se com a Palavra diariamente. Seus pr√≥ximos passos s√£o fundamentais.'; }
      else if (total <= 60) { icon = 'üåø'; title = 'MUDA'; gradient = 'var(--sprout)'; profile = 'Crescendo e Firmando Ra√≠zes'; desc = 'Voc√™ j√° deu passos importantes, mas ainda precisa firmar suas ra√≠zes para n√£o ser levado por qualquer vento. Foque na renova√ß√£o da mente, no compromisso com a comunidade e na pr√°tica da honra. A fase de crescimento requer nutrientes constantes.'; }
      else if (total <= 80) { icon = 'üå≥'; title = '√ÅRVORE'; gradient = 'var(--tree)'; profile = 'Amadurecendo para o Servi√ßo'; desc = 'Voc√™ est√° amadurecendo de forma bonita! Tem conhecimento, compromisso e cora√ß√£o para servir. Agora √© hora de descobrir (ou aprofundar) seus dons e come√ßar a gerar frutos: sirva ativamente, mentoreie algu√©m e amplie sua tenda. Voc√™ est√° pronto!'; }
      else { icon = 'üî•'; title = 'DISC√çPULO RADICAL'; gradient = 'var(--fire)'; profile = 'Pronto para Multiplicar'; desc = 'Voc√™ √© uma refer√™ncia de maturidade. Sua vida √© marcada por ren√∫ncia, mente renovada, comunh√£o profunda, honra √† lideran√ßa e servi√ßo apaixonado. Seu pr√≥ximo desafio: MULTIPLICAR. Forme disc√≠pulos, lidere com excel√™ncia e nunca pare de crescer. O Reino depende de radicais como voc√™!'; }

      document.getElementById('quiz-section').style.display = 'none';
      const r = document.getElementById('resultSection');
      r.style.display = 'block';
      document.getElementById('resIcon').textContent = icon;
      document.getElementById('resTitle').textContent = title;
      document.getElementById('resScore').textContent = total + '/100';
      const p = document.getElementById('resProfile');
      p.textContent = profile;
      p.style.background = gradient;
      p.style.color = '#fff';
      document.getElementById('resDesc').textContent = desc;

      let catHtml = '';
      CATS.forEach((c, i) => {
        const pct = catTotals[i] / 20 * 100;
        catHtml += `<div class="cat-score-item"><div class="cat-score-top"><span class="cat-score-name">${c.icon} ${c.name}</span><span class="cat-score-val">${catTotals[i]}/20</span></div><div class="cat-score-bar"><div class="cat-score-fill" style="width:${pct}%;background:${c.color}"></div></div></div>`;
      });
      document.getElementById('catScores').innerHTML = catHtml;

      // POPULAR CABE√áALHO DE IMPRESS√ÉO
      document.getElementById('printName').textContent = 'Nome: ' + userData.name;
      document.getElementById('printChurch').textContent = 'Igreja: ' + userData.church;
      document.getElementById('printDate').textContent = new Date().toLocaleDateString('pt-BR');

      window.scrollTo({ top: 0, behavior: 'smooth' });

      // PREPARAR DADOS PARA ENVIO
      const finalData = {
        nome: userData.name,
        igreja: userData.church,
        total: total,
        perfil: title,
        cat_renuncia: catTotals[0],
        cat_mente: catTotals[1],
        cat_comunhao: catTotals[2],
        cat_honra: catTotals[3],
        cat_servico: catTotals[4],
        respostas: answers
      };

      saveAndSend(finalData);
    };

    // --- L√ìGICA DE SINCRONIZA√á√ÉO E OFFLINE ---

    function saveAndSend(data) {
      if (!navigator.onLine) {
        saveLocal(data);
        showSyncStatus('off');
      } else {
        sendToGoogle(data);
      }
    }

    function saveLocal(data) {
      let pending = JSON.parse(localStorage.getItem('pendingDiagnosticos') || '[]');
      pending.push(data);
      localStorage.setItem('pendingDiagnosticos', JSON.stringify(pending));
    }

    function sendToGoogle(data) {
      if (GOOGLE_SCRIPT_URL.includes('COLE_AQUI')) {
        console.warn('URL do Script n√£o configurada!');
        showSyncStatus('success');
        return;
      }

      showSyncStatus('sync');

      // Usando text/plain para evitar Preflight (OPTIONS) que costuma falhar no Apps Script
      fetch(GOOGLE_SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        cache: 'no-cache',
        redirect: 'follow',
        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
        body: JSON.stringify(data)
      })
        .then(() => {
          showSyncStatus('success');
        })
        .catch(err => {
          console.error('Erro no envio, salvando local:', err);
          saveLocal(data);
          showSyncStatus('off');
        });
    }

    function syncPendingData() {
      if (!navigator.onLine) return;
      const pending = JSON.parse(localStorage.getItem('pendingDiagnosticos') || '[]');
      if (pending.length === 0) return;

      showSyncStatus('sync');

      const item = pending.shift();

      if (GOOGLE_SCRIPT_URL.includes('COLE_AQUI')) {
        localStorage.setItem('pendingDiagnosticos', JSON.stringify(pending));
        if (pending.length > 0) setTimeout(syncPendingData, 500);
        else showSyncStatus('success');
        return;
      }

      fetch(GOOGLE_SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        cache: 'no-cache',
        redirect: 'follow',
        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
        body: JSON.stringify(item)
      })
        .then(() => {
          localStorage.setItem('pendingDiagnosticos', JSON.stringify(pending));
          if (pending.length > 0) {
            setTimeout(syncPendingData, 500);
          } else {
            showSyncStatus('success');
          }
        })
        .catch(err => {
          pending.unshift(item);
          localStorage.setItem('pendingDiagnosticos', JSON.stringify(pending));
          showSyncStatus('off');
        });
    }

    function showSyncStatus(status) {
      const el = document.getElementById('syncStatus');
      const icon = document.getElementById('syncIcon');
      const msg = document.getElementById('syncMsg');

      el.style.display = 'flex';

      if (status === 'off') {
        el.style.border = '1px solid #f97316';
        icon.textContent = '‚òÅÔ∏è';
        msg.textContent = 'Salvo Offline.';
        setTimeout(() => el.style.display = 'none', 5000);
      }
      else if (status === 'sync') {
        el.style.border = '1px solid #6c5ce7';
        icon.textContent = 'üîÑ';
        msg.textContent = 'Sincronizando...';
      }
      else if (status === 'success') {
        el.style.border = '1px solid #22c55e';
        icon.textContent = '‚úÖ';
        msg.textContent = 'Salvo!';
        setTimeout(() => el.style.display = 'none', 4000);
      }
    }

    // Iniciar listeners
    window.addEventListener('online', syncPendingData);
    window.addEventListener('load', syncPendingData);

  </script>
</body>

</html>